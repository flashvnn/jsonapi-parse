!function(t,n){function r(t){var n,r;return n=f(t.data,function(n){return e(n,t.included),i(n)}),r={data:n,jsonapi:t.jsonapi||{}},t.meta&&(r.meta=t.meta),t.errors&&(r.errors=t.errors),r}function e(t,n,r){t.relationships&&(r=r?r.concat([t]):[t]),s(t.relationships,function(e,i){e.data&&(a(e.data)?t.attributes[i]=f(e.data,function(t){return o(t,n,r)}):t.attributes[i]=o(e.data,n,r))})}function o(t,n,r){var o,a;return(o=l(r,{id:t.id,type:t.type}))?t:(a=l(n,{id:t.id,type:t.type}))?(e(a,n,r),i(a)):t}function i(t){return j({},{links:t.links},t.attributes,{id:t.id})}function a(t){return"[object Array]"===Object.prototype.toString.call(t)}function u(t){return"[object String]"===Object.prototype.toString.call(t)}function c(t){return"[object Object]"===Object.prototype.toString.call(t)}function p(t){return t===n}function s(t,n){var r;if(a(t))for(r=0;r<t.length;r+=1)n(t[r],r);else if(c(t))for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n(t[r],r)}function f(t,n){var r=[];return s(t,function(t,e){r.push(n(t,e))}),r}function d(t){var n=!0;return s(t,function(t){t!==!0&&(n=!1)}),n}function l(t,n){var r;return s(t,function(t){var e=f(n,function(n,r){return t[r]===n});d(e)&&(r=t)}),r}function j(){var t=Object(null),n=Array.prototype.slice.call(arguments);return s(n,function(n){s(n,function(n,r){t[r]=n})}),t}var y=t.jsonapi||(t.jsonapi={});y.parse=function(n){var e,o;if(u(n))try{e=t.JSON.parse(n)}catch(i){if("SyntaxError"===i.name)return n;throw i}else{if(!c(n))return n;e=n}return p(e.data)&&p(e.errors)&&p(e.meta)?e:e.jsonapi&&e.jsonapi.parsed?e:(o=r(e),o.jsonapi.parsed=!0,o)},"object"==typeof exports?c(module)&&c(module.exports)&&(exports=module.exports=y):t.jsonapi=y}("undefined"==typeof window?this:window);